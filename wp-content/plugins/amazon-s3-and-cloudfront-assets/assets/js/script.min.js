!function(a,b){function c(b){a(".custom-endpoint-url-generating").toggle(!b),a(".custom-endpoint-url").toggle(b),a(".refresh-url-wrap").toggle(b)}function d(){var b=a("#as3cf-cdn-gzip-notice");"cloudfront"===a('#tab-assets input[name="domain"]:checked').val()&&a("#enable-gzip").is(":checked")?b.show():b.hide()}function e(b){p.html(b);var c=!1;a("#enable-cron").is(":checked")&&a("#enable-addon").is(":checked")&&p.html()&&(c=!0),p.toggleClass("hide",!c)}function f(){var b={_nonce:as3cf_assets.nonces.get_progress,action:"as3cf-assets-get-progress"};a.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:b,success:function(a){g(a)}})}function g(a){!0!==a.is_scanning&&!0!==a.is_purging&&!0!==a.is_processing?(m.hide(),h(!1,a),q=0,i(0,o)):(m.show(),h(!0,a),q!==a.progress&&i(a.progress,o),q=a.progress),n.html(a.description),e(a.next_scan)}function h(b,c){b?a(".as3cf-manual-button").addClass("disabled"):a(".as3cf-manual-button").removeClass("disabled"),!0!==c.scan_allowed&&a("#as3cf-assets-manual-scan").addClass("disabled"),!0!==c.purge_allowed&&a("#as3cf-assets-manual-purge").addClass("disabled")}function i(b,c){a(c).animate({width:b+"%"},1200)}var j,k=a("#tab-assets"),l=a("#assets-progress"),m=a("#assets-progress .progress-bar-wrapper"),n=a("#assets-progress .block-description"),o=a("#assets-progress .progress-bar"),p=a("#assets-progress .next-scan"),q=0;a(document).ready(function(){a(".as3cf-setting.enable-custom-endpoint").on("click","#refresh-url",function(b){b.preventDefault(),c(!1);var d={_nonce:as3cf_assets.nonces.generate_key,action:"as3cf-assets-generate-key"};a.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:d,error:function(a,b,d){alert(as3cf_assets.strings.generate_key_error+d),c(!0)},success:function(b,d,e){"undefined"!=typeof b.success?(a("#custom-endpoint-key").val(b.key),a(".display-custom-endpoint-key").html(b.key)):alert(as3cf.strings.generate_key_error+b.error),c(!0)}})}),l.on("click",".as3cf-manual-button",function(c){if(c.preventDefault(),!a(this).hasClass("disabled")){q=0,a(".as3cf-manual-button").addClass("disabled"),i(0,o),m.show();var d=a(this).attr("id"),e=d.replace(/-/g,"_");e=e.replace("as3cf_assets_",""),b.ajax.send(d,{data:{_nonce:as3cf_assets.nonces[e]}}),"manual_scan"===e?n.html(as3cf_assets.strings.scanning):"manual_purge"===e&&n.html(as3cf_assets.strings.purging)}}),d(),k.on("change",'input[name="domain"], #enable-gzip-wrap',function(a){d()}),1!==m.data("scanning")&&1!==m.data("purging")&&1!==m.data("processing")||(q=0,a(".as3cf-manual-button").addClass("disabled"),m.show(),i(m.data("percentage"),o)),j=setInterval(f,5e3)})}(jQuery,wp);